
\subsection{Explicación detallada del algoritmo}

En la sección anterior analizamos varios algoritmos de búsqueda local.
La búsqueda local es una heuristica para algoritmos aproximados.
Sin embargo, las heurísticas de búsqueda local pueden verse como un algoritmo de \emph{gradient descent}.
Estos algoritmos tienen el problema de los mínimos locales: cuando encuentran un mínimo local se quedan trabados y no pueden mejorar esa solución no óptima. 

Por esa razón surgen las metaheuristicas.
Una metaheurística es un método heurístico para resolver un  problema computacional general.
Una meteheurística usa los parámetros dados por el usuario sobre unos procedimientos genéricos y abstractos. 
Normalmente, estos procedimientos son heurísticos.

En particular, nosotros utilizaremos la metaheurística del tabu search, que a su vez se basa en la heurística de búsqueda local.
Una explicación completa de la heurística de tabú search puede encontrarse en \cite{tabusearch}.

Expliquemos los detalles de nuestra implementación antes de ver el pseudocódigo.

Nuestra lista tabú en nuestro caso debería contener soluciones posibles, es decir, isomorfismos. Sin embargo, como comparar isomorfismos es muy caro, decidimos usar una función de hash y almacenar este valor. De esta manera, buscar soluciones en la lista tabú se vuelve mucho menos costoso.

Nuestra función de aspiración, es decir, nuestro método para elegir el isomorfismo inicial de la siguiente iteración hace lo obvio si hay alguna solución no tabú: elige la mejor.
Sin embargo, si todas las soluciones son tabú, elegiremos la mejor solución tabú en cuestión.

No creemos que fuera adecuado elegir ningun \emph{movimiento prohibido}, como vimos en la teórica (la definición de movimiento prohibido no existe en la definición original de la metaheuristica tabu search, si no que es una adición posterior), dado que no parecía razonable prohibir ningún movimiento ni ninguna solución particular (más allá de la tabú).
Esto se debe principalmente a que no hay características que hagan que, inmediatamente, podamos descartar una solución y declararla inviable.

Sin más que explicar, veamos nuestra implementación.


\begin{algorithm}[H]
  \begin{algorithmic}[1]
  \caption{Pseudocódigo del procedimiento Tabu Search}
  \label{algo:6-1}
    \Procedure{tabu\_search}
              {\texttt{Grafo} $g1$,
               \texttt{vector<int>} $vertices1$,
               \texttt{Grafo} $g2$,
               \texttt{vector<int>} $vertices2$} 
    \State $source \gets goloso(g1, vertices1, g2, vertices2)$
    \State $lista\_tabu \gets lista(1000, make\_pair(0, 0))$
    \State $indice\_lista\_tabu \gets 0$
    \State Inicializar estructuras relacionadas con el criterio de parada.
    \While {criterio de parada} 
       \State $mejor\_tabu \gets \{.isomorfismo = Isomorfismo(), .aristas = 0\}$
       \State $mejor\_solucion \gets \{.isomorfismo = Isomorfismo(), .aristas = 0\}$
       \For $vecino \in vecindad(source)$
           \State $aristas \gets buscar(lista_tabu, hash(vecino))$
           \If {$aristas = 0$}
               \Comment Source es una solución tabu.
               \If {$aristas > mejor\_tabu.aristas$}
                   \State $mejor\_tabu.aristas \gets aristas$
                   \State $mejor\_tabu.isomorfismo \gets vecino$
                   \State continue
               \EndIf
           \Else
               \State $aristas = contar\_aristas\_isomorfismo(g1, g2, vecino)$
               \If {$aristas > mejor\_tabu.aristas$}
                   \State $mejor\_solucion.aristas \gets aristas$
                   \State $mejor\_solucion.isomorfismo \gets vecino$
                   \State continue
               \EndIf
           \EndIf
        \EndFor
        \If {$mejor\_solucion.aristas > 0$}
            \State $lista\_tabu.push\_back($
            \State \,\,  $make\_pair(
              hash(mejor\_solucion.isomorfismo),
              mejor\_solucion.aristas))$
            \If {$lista\_tabu.size() > lista\_tabu\_limite$}
                 \State $lista\_tabu.pop\_front()$
            \EndIf
        \EndIf
        \If {$mejor\_solucion.aristas = 0$}
           \Comment Todas las soluciones son tabu.
           \State $source \gets mejor\_tabu$
       \Else
           \State $source \gets mejor\_solucion$
       \EndIf
       \State Actualizar estructuras relacionadas con el criterio de parada.
    \EndWhile
           
		\EndProcedure
	\end{algorithmic}
\end{algorithm}






\subsection{Performance del algoritmo}

\input{ejer6_exp.tex}
